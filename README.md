 # **Karina College**

📌 **프로젝트 소개**

    트래픽이 몰릴 수강용 시스템만 분리해 서비스별 확장을 위해 
    수강신청용 대학교 사이트를 학생용과 수강신청용으로 나누어 MSA 방식으로 개발하고 
    수강 신청 기간에 과도한 트래픽을 서버가 감당하지 못해서 원활하게 진행하지 못하는 경우를 대비하기 위해 
    쿠버네티스, AWS 클라우드를 사용해 구축하였습니다.


📌 **사용스킬**

      java, aws, gitAction, argoCD, prometeus, MariaDB, STS, VSCode, kubernetese, Grafana, terraform, JWT


📌 **진행기간**

    2023/12/26 → 2024/02/06


📌 **팀원**

     김하린아, 한찬희, 문원선, 황지현
 

## **1. Dev**


- **회원용과 수강신청용 서비스로 나누어 MSA로 프로젝트를 설계**

- **회원 서비스**

    로그인 (JWT 이용)
     
    학생 정보 조회
    
    학번조회 (SMS 본인인증)
    
    비밀번호 변경 (SMS 본인인증)
    
- **관리자 서비스**
    
    학생/ 강의/ 교수 각각 추가, 수정, 삭제
    
- **수강신청 서비스**
    
    수강신청 사이트 오픈  
    
    강의 조건별 검색 (강의명, 과목코드, 교수, 날짜, 시간, 학과 등)
    
    수강 카트 담기 및 신청
    
    시간표
    


✔️ **나의 담당 기능**

- **회원**
    - 관리자 기능 제외한 전체적인 회원 기능
        
    

- **수강신청**
    - 수강신청 사이트 오픈
    - 강의 조건별 검색
    - 시간표
    

## 2. Ops
  
- 깃액션

- ECR + 아르고CD

- EKS

- ingress

- kubenetes

- terraform 


✔️ **요약**

- CI/CD :  Git Hub Git Action, ECR ArgoCD
- Web Service Image를 사용자는 Domain을 통해 접근한 후 ACM에서 Cname을 통한 인증과 WAF를 거친 후 로드밸런서를 통해 ECR내의 EKS에 있는 노출된 pod로 접속하게 구축하였습니다.
- 트래픽이 몰릴 경우 필요한 서비스만 늘어날 수 있게 하기 위해 MSA방식을 도입하였습니다.  ingress를 사용하여 url 구분을 통해 학생 용과 수강 신청 용 사이트를 분리하였습니다.
- prometeus와 grafana 이용해 모니터링 할 수 있도록 하였습니다.

  
✔️ **나의 담당 기능**

- 쿠버네티스 - 로드밸런서 생성, 인그레스를 통해 도메인 URL을 /student /subject로 분리, Helm 설치
    
- 테라폼 - vpc, 서브넷, ecr, eks, bastion EC2, 보안그룹

## 3. 보완점 및 느낀점

MSA 형식으로 처음 프로젝트를 해봐서 로그인 방식에서 토큰 유지를 시키는 방법, CI/CD시에 많은 용량을 필요로 해서 예산을 늘리거나 다른 방식의 CI/CD를 선택 해야 하는 과정 등에서 어려움이 있었습니다. 

로그인 여부를 판별하는 과정에서 세션 사용이 불가능해서 REST API나 JWT를 고려하던 과정에서 각각의 방식으로 시도해본 후 공유할 데이터가 많지 않음을 고려했을 때 JWT방식을 선택하는 것이 가격 면에서 좀 더 유리 할 것이라는 판단을 내렸고 토큰을 판별하기 위해 잘 사용해보지 않았던 AJAX를 모든 기능에 사용해야 하는 경우가 생겨 많은 시간이 걸렸습니다. 

MSA로 프로젝트를 진행한 결과 좀 더 큰 용량의 EC2가 필요하게 되면서 jenkins + github를 사용했던 CI/CD방식을 중간에 다시 한번 바꾸게 되면서 많은 시간을 보내게 되었습니다. 그렇지만 그 덕분에 좀 더 많은 방식의 개발, CI/CD를 시도해 볼 수 있었고 각각의 장단점, 빌드 할 시의 속도차이 등을 바로 비교가 가능하게 되면서 오히려 좋았다고 생각합니다.

쿠버네티스 적용 시에 들여쓰기나 OIDC의 오타로 인해 정책, 역할이 올바르게 생성되지 않아서 로드밸런서가 생기지 않아서 시간을 허비하기도 하면서 오타를 좀 더 꼼꼼히 살펴보게 되었습니다. 

Ingress를 URL을 통해 분리를 할 때 URL 정리가 완벽히 되지 않아서 다시 개발 단계로 돌아가기도 하였습니다.

아쉬웠던 점은 개발과 인프라 팀의 진행 과정을 서로 공유하고 시도 해볼 수 있도록 각각 스터디시간을 중간 중간 갖기로 했던 목표는  완료하지 못하였습니다. 하지만 각자 서로의 진행 과정을 대략 정리 해놓았기에 프로젝트 완료 후에 내가 하지 않은 파트까지 공부해보고 따라해 볼 수 있었습니다.  

